import numpy as np
import matplotlib.pyplot as plt
import os

#6.444359302520752
SloadTimes= [[1685243020.8177757, 1685243021.037768], [1685243021.057561, 1685243021.228741], [1685243021.3244836, 1685243021.5174491], [1685243021.6117835, 1685243021.870843], [1685243022.0289721, 1685243022.3784938]]
SmainTimes= [[1685243020.8140926, 1685243020.8174405], [1685243021.0379024, 1685243021.0417602], [1685243021.3126254, 1685243021.324238], [1685243021.602865, 1685243021.6115365], [1685243022.0197067, 1685243022.0286815], [1685243022.3844788, 1685243022.3919215]]
SmainNoTimes= [[1685243020.7056034, 1685243020.7056034], [1685243020.823973, 1685243020.8551254], [1685243021.0425832, 1685243021.0638518], [1685243021.3360822, 1685243021.377803], [1685243021.6209838, 1685243021.7252996], [1685243022.0338826, 1685243022.0668194]]
SupTimes= [[1685243020.706642, 1685243020.8140857], [1685243021.0378518, 1685243021.0378997], [1685243021.2288163, 1685243021.3126183], [1685243021.517767, 1685243021.6028588], [1685243021.8709261, 1685243022.0197022], [1685243022.3843968, 1685243022.384475]]

#2.580954074859619
SloadTimes= [[1685244135.8143518, 1685244135.8797226], [1685244135.882903, 1685244135.947688], [1685244135.97596, 1685244136.0373807], [1685244136.0659614, 1685244136.129439], [1685244136.1694827, 1685244136.2432268], [1685244136.2508194, 1685244136.250828]]
SmainTimes= [[1685244135.811206, 1685244135.814197], [1685244135.8798666, 1685244135.8827648], [1685244135.9729054, 1685244135.97581], [1685244136.0629148, 1685244136.0658545], [1685244136.1659925, 1685244136.169216], [1685244136.2478845, 1685244136.250701]]
SmainNoTimes= [[1685244135.7810807, 1685244135.7810807], [1685244135.8176024, 1685244135.871148], [1685244135.8835158, 1685244135.9291105], [1685244135.9802482, 1685244136.020377], [1685244136.0660436, 1685244136.1168473], [1685244136.1784825, 1685244136.2444293]]
SupTimes= [[1685244135.7819943, 1685244135.8112025], [1685244135.8798294, 1685244135.8798656], [1685244135.9477782, 1685244135.972902], [1685244136.037433, 1685244136.062911], [1685244136.1294973, 1685244136.165983], [1685244136.24784, 1685244136.247883]]

SloadTimes= [[1685616919.3604372, 1685616922.225538], [1685616922.679326, 1685616923.3432443], [1685616923.9328399, 1685616924.5990517], [1685616925.1886795, 1685616926.0080044], [1685616927.0465314, 1685616928.3931794], [1685616929.0189414, 1685616929.018955]]
SmainTimes= [[1685616919.3567026, 1685616919.3601456], [1685616922.651622, 1685616922.679006], [1685616923.8934987, 1685616923.9292254], [1685616925.1378305, 1685616925.1796813], [1685616927.01147, 1685616927.046216], [1685616929.011839, 1685616929.0186539]]
SmainNoTimes= [[1685616919.2590878, 1685616919.2590878], [1685616919.378506, 1685616922.594684], [1685616922.695458, 1685616923.5286407], [1685616923.9373455, 1685616925.0262043], [1685616925.1909542, 1685616926.539892], [1685616927.1254046, 1685616928.956367]]
SupTimes= [[1685616919.2600784, 1685616919.356695], [1685616922.6514876, 1685616922.6516175], [1685616923.6368628, 1685616923.8934915], [1685616925.1377082, 1685616925.1378272], [1685616926.6292577, 1685616927.0114524], [1685616929.011728, 1685616929.0118356]]

SloadTimes= [[1685617692.480975, 1685617692.5522406], [1685617692.5554945, 1685617692.6156678], [1685617692.6515203, 1685617692.7450109], [1685617692.749256, 1685617692.8503819], [1685617692.9318871, 1685617693.063163], [1685617693.0662918, 1685617693.0663]]
SmainTimes= [[1685617692.47788, 1685617692.48077], [1685617692.5523398, 1685617692.5553486], [1685617692.6484008, 1685617692.6513603], [1685617692.746225, 1685617692.7490864], [1685617692.9283655, 1685617692.9316978], [1685617693.06332, 1685617693.0661936]]
SmainNoTimes= [[1685617692.4446616, 1685617692.4446616], [1685617692.4843676, 1685617692.5286841], [1685617692.55606, 1685617692.6179578], [1685617692.6540976, 1685617692.7385535], [1685617692.7509475, 1685617692.7788298], [1685617692.9348261, 1685617692.9792798]]
SupTimes= [[1685617692.4456081, 1685617692.4778752], [1685617692.552302, 1685617692.5523381], [1685617692.6196768, 1685617692.648396], [1685617692.7461734, 1685617692.7462242], [1685617692.8504686, 1685617692.928361], [1685617693.0632808, 1685617693.063318]]

SloadTimes= []
SmainTimes= [[1685616525.721799, 1685616525.7250059], [1685616525.77251, 1685616525.7757173], [1685616525.8207247, 1685616525.8236825], [1685616525.8697224, 1685616525.8729846], [1685616525.9429946, 1685616525.946014], [1685616526.0474117, 1685616526.050414]]
SmainNoTimes= [[1685616525.6907787, 1685616525.6907787], [1685616525.7273912, 1685616525.7416842], [1685616525.7763617, 1685616525.7906976], [1685616525.8250854, 1685616525.838104], [1685616525.874499, 1685616525.8892078], [1685616525.948704, 1685616525.9672365]]
SupTimes= [[1685616525.69168, 1685616525.7217975], [1685616525.7440257, 1685616525.7725081], [1685616525.7921731, 1685616525.8207235], [1685616525.8395667, 1685616525.869721], [1685616525.8897479, 1685616525.9429932], [1685616525.9704099, 1685616526.0474105]]









plt.figure(figsize=(50, 5))
plt.yticks(fontsize=32)


def plt_soc(loadTime, mainTime, upTime, mainNoTime):
    basetime = upTime[0][0]

    loadSum = 0
    mainSum = 0
    upSum = 0
    mainNoSum = 0

    ax_list = ["load Thread"]
    for i in range(len(loadTime)):
        plt.barh(ax_list, loadTime[i][1] - loadTime[i][0], height=0.6, color="pink", left=loadTime[i][0]-basetime,
                 edgecolor='black')
        loadSum += (loadTime[i][1] - loadTime[i][0])

    ax_list = ["main"]
    for i in range(len(mainTime)):
        plt.barh(ax_list, mainTime[i][1] - mainTime[i][0], height=0.6, color="red",
                 left=mainTime[i][0]-basetime, edgecolor='black')
        mainSum += (mainTime[i][1] - mainTime[i][0])

    for i in range(len(upTime)):
        plt.barh(ax_list, upTime[i][1] - upTime[i][0], height=0.6, color="blue", left=upTime[i][0]-basetime,
                 edgecolor='black')
        upSum += ( upTime[i][1] - upTime[i][0])

    for i in range(len(mainNoTime)):
        plt.barh(ax_list, mainNoTime[i][1] - mainNoTime[i][0], height=0.6, color="green", left=mainNoTime[i][0]-basetime,
                 edgecolor='black')
        mainNoSum += (mainNoTime[i][1] - mainNoTime[i][0])

    print("attn+ffn+attn+gate", mainNoSum, "preload", loadSum)
    print("load", upSum)
    print("experts", mainSum)


plt_soc(SloadTimes, SmainTimes, SupTimes, SmainNoTimes)
# plt.legend(fontsize=32)
plt.gca().invert_yaxis()

plt.show()
# plt.savefig(os.path.dirname(os.path.realpath(__file__))+"/barplot/moe-6.444359302520752.png", bbox_inches="tight")

